image: Ubuntu1804
version: '1.0.{build}'
shallow_clone: false
skip_branch_with_pr: true
services:
- docker

branches:
  only:
    - master

install:

build: off

build_script:
  - cd src/TeamsidToBitwardenConverter
  - docker build -t teamsidtobitwardenconverter -f Dockerfile .
  - docker run -i --rm -v ${APPVEYOR_BUILD_FOLDER}/src/TeamsidToBitwardenConverter/pack:/app/pack teamsidtobitwardenconverter

test_script:

deploy:
  - provider: NuGet
    api_key:
      secure: 7zpjFrJRFYqsLO6bOzzntKph8Bg1OMrMAvJnfPduGVAiMItbjpaHqCAiWy2qu/d3
    skip_symbols: false
    artifact: ${APPVEYOR_BUILD_FOLDER}/src/pack/.*\.nupkg/
    on:
      branch: master
      APPVEYOR_REPO_TAG: true
